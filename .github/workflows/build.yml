name: Build

on: push

jobs:
#  linux:
#    runs-on: ${{ matrix.os }}
#
#    strategy:
#      matrix:
#        include:
#        - os: ubuntu-18.04
#          cuda: "10.2"
#        - os: ubuntu-16.04
#          cuda: "9.2"
#
#    steps:
#    - uses: actions/checkout@v2
#
#    - name: Install CUDA
#      env:
#        CUDA: ${{ matrix.cuda }}
#      run: .github/tools/linux-install-cuda.sh
#
#    - name: Install Vulkan
#      run: .github/tools/linux-install-vulkan.sh
#
#    - run: cmake .
#
#    - run: make
#
#    - uses: actions/upload-artifact@v2
#      with:
#        name: libgpu-setup-cuda-${{ matrix.cuda }}-${{ matrix.os }}.so
#        path: src/libgpu-setup.so

  windows:
    runs-on: windows-2016

    steps:
    - uses: actions/checkout@v2

    #- run: choco install cuda --version=10.2.89 --checksum b538271c4d9ffce1a8520bf992d9bd23854f0f29cee67f48c6139e4cf301e253

    #- run: choco install vulkan-sdk

    - run: find /c -iname "cmake*"
      shell: bash

    - run: |
        where cmake
        c:
        cd "c:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\VC\Auxiliary\Build"
        call vcvars64.bat
        cd "c:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CommonExtentions\Microsoft\CMake\CMake\bin"
        dir
        cmake -G "Ninja" -DCMAKE_BUILD_TYPE="Debug" -DCMAKE_MAKE_PROGRAM="c:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CommonExtensions\Microsoft\CMake\Ninja\ninja.exe" d:\a\gpu-post\gpu-post
        cmake --build d:\a\gpu-post\gpu-post
      shell: cmd

    # - run: .github/tools/windows-build.ps1
